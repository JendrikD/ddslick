!function(e){e.fn.ddslick=function(t){return d[t]?d[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exists."):d.init.apply(this,arguments)};var d={},t={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,onSelected:function(){}};function i(e,d,t){t=!1!==t;var i,n,s,l,a=e.data("ddslick"),c=e.find(".dd-selected"),r=c.siblings(".dd-selected-value"),p=e.find(".dd-option").eq(d),f=p.closest("li"),h=a.settings,u=a.settings.data[d];e.find(".dd-option").removeClass("dd-option-selected"),p.addClass("dd-option-selected"),a.selectedIndex=d,a.selectedItem=f,a.selectedData=u,h.showSelectedHTML?c.html((u.imageSrc?'<img class="dd-selected-image'+("right"===h.imagePosition?" dd-image-right":"")+'" src="'+u.imageSrc+'" />':"")+(u.text?'<label class="dd-selected-text">'+u.text+"</label>":"")+(u.description?'<small class="dd-selected-description dd-desc'+(h.truncateDescription?" dd-selected-description-truncated":"")+'" >'+u.description+"</small>":"")):c.html(u.text),r.val(u.value),a.original.val(u.value),e.data("ddslick",a),o(e),n=(i=e).find(".dd-select").css("height"),s=i.find(".dd-selected-description"),l=i.find(".dd-selected-image"),s.length<=0&&l.length>0&&i.find(".dd-selected-text").css("lineHeight",n),t&&"function"==typeof h.onSelected&&h.onSelected.call(this,a)}function n(d){var t,i=d.find(".dd-select"),n=i.siblings(".dd-options"),o=i.find(".dd-pointer"),s=n.is(":visible");e(".dd-click-off-close").not(n).slideUp(50),e(".dd-pointer").removeClass("dd-pointer-up"),i.removeClass("dd-open"),s?(n.slideUp("fast"),o.removeClass("dd-pointer-up"),i.removeClass("dd-open")):(i.addClass("dd-open"),n.slideDown("fast"),o.addClass("dd-pointer-up")),(t=d).find(".dd-option").each(function(){var d=e(this),i=d.css("height"),n=d.find(".dd-option-description"),o=t.find(".dd-option-image");n.length<=0&&o.length>0&&d.find(".dd-option-text").css("lineHeight",i)})}function o(e){e.find(".dd-select").removeClass("dd-open"),e.find(".dd-options").slideUp(50),e.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}d.init=function(d){var o=e.extend({},t,d);return e("#css-ddslick").length<=0&&o.embedCSS&&e('<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;} .dd-selected-text { font-weight:bold}</style>').appendTo("head"),this.each(function(){var o=e.extend({},t,d),s=e(this);if(!s.data("ddslick")){var l=[];s.find("option").each(function(){var d=e(this),t=d.data();l.push({text:e.trim(d.text()),value:d.val(),selected:d.is(":selected"),description:t.description,imageSrc:t.imagesrc})}),o.keepJSONItemsOnTop?e.merge(o.data,l):o.data=e.merge(l,o.data);var a=s,c=e("<div>").attr("id",s.attr("id")+"-dd-placeholder");s.replaceWith(c),(s=c).addClass("dd-container").append('<div class="dd-select"><input class="dd-selected-value" type="hidden" /><a class="dd-selected"></a><span class="dd-pointer dd-pointer-down"></span></div>').append('<ul class="dd-options"></ul>'),s.find("input.dd-selected-value").attr("id",e(a).attr("id")).attr("name",e(a).attr("name"));l=s.find(".dd-select");var r=s.find(".dd-options");r.css({width:o.width}),l.css({width:o.width,background:o.background}),s.css({width:o.width}),null!==o.height&&r.css({height:o.height,overflow:"auto"}),e.each(o.data,function(e,d){d.selected&&(o.defaultSelectedIndex=e),r.append('<li><a class="dd-option">'+(d.value?' <input class="dd-option-value" type="hidden" value="'+d.value+'" />':"")+(d.imageSrc?' <img class="dd-option-image'+("right"===o.imagePosition?" dd-image-right":"")+'" src="'+d.imageSrc+'" />':"")+(d.text?' <label class="dd-option-text">'+d.text+"</label>":"")+(d.description?' <small class="dd-option-description dd-desc">'+d.description+"</small>":"")+"</a></li>")});var p={settings:o,original:a,selectedIndex:-1,selectedItem:null,selectedData:null};if(s.data("ddslick",p),o.selectText.length>0&&null===o.defaultSelectedIndex)s.find(".dd-selected").html(o.selectText);else{var f=null!==o.defaultSelectedIndex&&o.defaultSelectedIndex>=0&&o.defaultSelectedIndex<o.data.length?o.defaultSelectedIndex:0;i(s,f,!1)}s.find(".dd-select").on("click.ddslick",function(){n(s)}),s.find(".dd-option").on("click.ddslick",function(){i(s,e(this).closest("li").index())}),o.clickOffToClose&&(r.addClass("dd-click-off-close"),s.on("click.ddslick",function(e){e.stopPropagation()}),e("body").on("click",function(){e(".dd-open").removeClass("dd-open"),e(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")}))}})},d.select=function(d){return this.each(function(){var t,n,o;void 0!==d.index&&i(e(this),d.index),d.id&&(t=e(this),n=d.id,o=t.find(".dd-option-value[value= '"+n+"']").parents("li").prevAll().length,i(t,o))})},d.open=function(){return this.each(function(){var d=e(this);d.data("ddslick")&&n(d)})},d.close=function(){return this.each(function(){var d=e(this);d.data("ddslick")&&o(d)})},d.destroy=function(){return this.each(function(){var d=e(this),t=d.data("ddslick");if(t){var i=t.original;d.removeData("ddslick").unbind(".ddslick").replaceWith(i)}})}}(jQuery);